sudo su -

##kubectl Installation
sudo snap install kubectl --classic
kubectl version --client

##awscli
sudo snap install aws-cli --classic
aws --version

##Now Create an IAM Role with below permission to attach to the ec2 so that the EC2 can access kubernetes cluster
MAKE SURE U CREATE THE ROLE WITH NAME WHICH CAN BE FURTHER USE IN AWS-AUTH CONFIGMAP
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "EKSReadAccess",
      "Effect": "Allow",
      "Action": [
        "eks:DescribeCluster",
        "eks:ListClusters",
        "eks:AccessKubernetesApi"
      ],
      "Resource": "*"
    }
  ]
}

sudo useradd devops
sudo mkdir /home/devops
sudo chown devops:devops /home/devops
sudo su
sudo visudo
ADD BELOW LINE UNDER ROOT PRIVILEGE SPECIFICATION
devops  ALL=(ALL:ALL) NOPASSWD: ALL

sudo su devops
aws eks update-kubeconfig \
  --region ap-south-1 \
  --name <cluster-name>

now add below role into aws-auth config map
mapRoles: |
  - rolearn: arn:aws:iam::484468819850:role/new_node_iam_role
    groups:
      - system:bootstrappers
      - system:nodes
    username: system:node:{{EC2PrivateDNSName}}

  - rolearn: arn:aws:iam::484468819850:role/ec2-eks-role   # <-- ADD THIS
    username: admin
    groups:
      - system:masters


Now check the command
kubectl get pods 















